// Module included in the following assemblies:
//
// * backup_and_restore/application_backup_and_restore/backing_up_and_restoring/backing-up-applications.adoc

:_content-type: PROCEDURE
ifdef::cephs[]
[id="oadp-ceph-cephfs-restore_{context}"]
= Restoring data using OADP 1.2 Data Mover and CephFS storage

You can use OpenShift API for Data Protection (OADP) 1.2 Data Mover to restore data using CephFS storage if the shallow copy feature of CephFS was enabled for the back up procedure. The shallow copy feature is not used in the restore procedure.

ifdef::split[]
[id="oadp-ceph-split-restore_{context}"]
= Restoring data using OADP 1.2 Data Mover and split volumes (CephFS and Ceph RBD)

You can use OpenShift API for Data Protection (OADP) 1.2 Data Mover to restore data in an environment that has _split volumes_, that is, an environment that uses both CephFS and CephRBD,  if the shallow copy feature of CephFS was enabled for the back up procedure. The shallow copy feature is not used in the restore procedure.
endif::[]

.Procedure

. Delete the application namespace by running the following command:
+
[source,terminal]
----
$ oc delete vsb -n <app_namespace> --all
----

. Delete any `VolumeSnapshotContent` CRs that were created during backup by by running the following command:
+
[source,terminal]
----
$ oc oc delete volumesnapshotcontent --all
----

. Create a `Restore` CR similar to the following:
+
.Example `Restore` CR
+
[source,yaml]
----
apiVersion: velero.io/v1
kind: Restore
metadata:
  name: <restore-name>
  namespace: <protected-ns>
spec:
  backupName: <previous-backup-name>
----

. Monitor the progress of the `VolumeSnapshotRestore` CRs by doing the following:
.. To check the progress of all the `VolumeSnapshotRestore` CRs, run the following command:
+
[source, terminal]
----
$ oc get vsr -n <app-ns>
----

.. To check the progress of a specific `VolumeSnapshotRestore` CR, run the following command:
+
[source,terminal]
----
$ oc get vsr <vsr-name> -n <app-ns> -ojsonpath="{.status.phase}
----

. Verify that your application data has been restored by running the following command:
+
[source,terminal]
----
$ oc get route <route-name> -n <app-ns> -ojsonpath="{.spec.host}"
----
